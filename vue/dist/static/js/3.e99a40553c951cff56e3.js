webpackJsonp([3],{HUme:function(e,t,i){var s=i("Tvb9");"string"==typeof s&&(s=[[e.i,s,""]]),s.locals&&(e.exports=s.locals);i("8bSs")("64b364e5",s,!0)},Tvb9:function(e,t,i){(e.exports=i("BkJT")(!0)).push([e.i,"\n.el-form[data-v-705586df]{\n  width: 70% !important;\n}\n","",{version:3,sources:["E:/other_project/studly/vue/src/views/system/role.vue"],names:[],mappings:";AACA;EACE,sBAAsB;CACvB",file:"role.vue",sourcesContent:["\n.el-form[data-v-705586df]{\n  width: 70% !important;\n}\n"],sourceRoot:""}])},tiUO:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"app-container"},[i("div",{staticClass:"filter-container"},[i("el-form",[i("el-form-item",[i("span",{staticClass:"title-contain"},[e._v("权限角色")])])],1),e._v(" "),i("el-form",[i("el-form-item",[e.hasPerm("role:add")?i("el-button",{attrs:{type:"primary",icon:"plus"},on:{click:e.showCreate}},[e._v("添加角色\n          ")]):e._e()],1)],1)],1),e._v(" "),i("div",{staticClass:"contain-table"},[i("el-table",{directives:[{name:"loading",rawName:"v-loading.body",value:e.listLoading,expression:"listLoading",modifiers:{body:!0}}],staticStyle:{width:"100%"},attrs:{data:e.list,"element-loading-text":"拼命加载中",border:"",fit:"","highlight-current-row":"","header-cell-style":{background:"#F5F6FC",color:"#1A1A1A"}}},[i("el-table-column",{attrs:{align:"center",label:"角色名称",prop:"roleName","min-width":"20%"}}),e._v(" "),i("el-table-column",{attrs:{align:"center",label:"创建时间",prop:"createTime","min-width":"20%",formatter:e.yyyymmddhhiiss}}),e._v(" "),i("el-table-column",{attrs:{align:"center",label:"操作","min-width":"30%"},scopedSlots:e._u([{key:"default",fn:function(t){return 1!=t.row.id?[e.hasPerm("role:update")||e.hasPerm("role:delete")?i("div",[e.hasPerm("role:update")?i("a",{staticClass:"oprator-class",on:{click:function(i){e.showUpdate(t.$index)}}},[e._v("编辑\n              ")]):e._e(),e._v(" "),t.row.users&&0===t.row.users.length&&e.hasPerm("role:delete")?i("a",{staticClass:"oprator-class",on:{click:function(i){e.removeRole(t.$index)}}},[e._v("\n                删除\n              ")]):e._e()]):e._e()]:void 0}}])})],1)],1),e._v(" "),i("el-dialog",{attrs:{title:e.textMap[e.dialogStatus],visible:e.dialogFormVisible,customClass:"customWidth"},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[i("el-form",{staticClass:"small-space",staticStyle:{width:"600px","margin-left":"50px"},attrs:{model:e.tempRole,"label-position":"left","label-width":"100px"}},[i("el-form-item",{attrs:{label:"角色名称",required:""}},[i("el-input",{staticStyle:{width:"250px"},attrs:{type:"text",maxlength:"6"},model:{value:e.tempRole.roleName,callback:function(t){e.$set(e.tempRole,"roleName",t)},expression:"tempRole.roleName"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"权限设置",required:""}},[i("el-tree",{ref:"tree",attrs:{data:e.allPermission,"show-checkbox":"","default-expand-all":"","node-key":"id","highlight-current":"",props:e.defaultProps}})],1)],1),e._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),"create"==e.dialogStatus?i("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:e.createRole}},[e._v("创 建")]):i("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:e.updateRole}},[e._v("修 改")])],1)],1)],1)},staticRenderFns:[]};var o=i("/Xao")({data:function(){return{loading:!1,list:[],allPermission:[],listLoading:!1,dialogStatus:"create",dialogFormVisible:!1,textMap:{update:"编辑权限角色",create:"添加权限角色"},tempRole:{roleName:"",roleId:"",permissions:[]},defaultProps:{children:"nextList",label:"permissionName"}}},created:function(){this.getList(),this.getAllPermisson()},methods:{getAllPermisson:function(){var e=this;this.api({url:"/system/listAllPermission",method:"get"}).then(function(t){e.allPermission=t})},getList:function(){var e=this;this.listLoading=!0,this.api({url:"/system/getAllRolesList",method:"get"}).then(function(t){e.listLoading=!1,e.list=t})},getIndex:function(e){return e+1},showCreate:function(){this.tempRole.roleName="",this.tempRole.roleId="",this.tempRole.permissions=[],this.checkMenu(),this.dialogStatus="create",this.dialogFormVisible=!0},showUpdate:function(e){var t=this.list[e];this.tempRole.roleName=t.roleName,this.tempRole.roleId=t.id,this.tempRole.permissions=[];for(var i=0;i<t.menus.length;i++){var s=t.menus[i].nextList;if(null!=s)for(var o=0;o<s.length;o++)this.tempRole.permissions.push(s[o].id)}this.checkMenu(),this.dialogStatus="update",this.dialogFormVisible=!0},createRole:function(){var e=this;this.loading=!0,this.checkdAll()||(this.tempRole.permissions=this.$refs.tree.getCheckedKeys(),this.api({url:"/system/addRole",method:"post",data:this.tempRole}).then(function(){e.getList(),e.dialogFormVisible=!1,e.$message({message:"新增成功",type:"success"})}).finally(function(){e.loading=!1}))},updateRole:function(){var e=this;this.loading=!0,this.checkdAll()||(this.tempRole.permissions=this.$refs.tree.getCheckedKeys(),this.api({url:"/system/updateRole",method:"post",data:this.tempRole}).then(function(){e.getList(),e.dialogFormVisible=!1,e.$message({message:"修改成功",type:"success"})}).finally(function(){e.loading=!1}))},removeRole:function(e){var t=this,i=this;this.$confirm("确定删除此角色?","提示",{confirmButtonText:"确定",showCancelButton:!1,type:"warning"}).then(function(){t.tempRole.roleId=i.list[e].id,i.api({url:"/system/deleteRole",method:"post",data:t.tempRole}).then(function(){i.getList()}).catch(function(e){})})},checkMenu:function(){var e=this;this.$nextTick(function(){e.$refs.tree.setCheckedKeys(e.tempRole.permissions)})},checkdAll:function(){return""==this.tempRole.roleName&&(this.$message({message:"请输入角色名称",type:"error"}),!0)}}},s,!1,function(e){i("HUme")},"data-v-705586df",null);t.default=o.exports}});