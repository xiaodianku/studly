webpackJsonp([9],{kzEz:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i("VsUZ"),s={data:function(){return{categoryList:[],list:[],listLoading:!1,dialogStatus:"create",dialogFormVisible:!1,title:"新增文章",tempObj:{},totalCount:0,listQuery:{pageNum:1,pageRow:10}}},created:function(){this.getCategoryList(),this.getList(),this.uploadurl="http://studly.whwen.cn:8085/home/uploadImage"},methods:{handleSizeChange:function(t){this.listQuery.pageRow=t,this.handleFilter()},handleCurrentChange:function(t){this.listQuery.pageNum=t,this.getList()},handleFilter:function(){this.listQuery.pageNum=1,this.getList()},getCategoryList:function(){var t=this;this.listLoading=!0,Object(a.a)({url:"/category/getList",method:"get"}).then(function(e){t.categoryList=e})},getList:function(){var t=this;this.listLoading=!0,Object(a.a)({url:"/article/getList",method:"get",params:this.listQuery}).then(function(e){t.listLoading=!1,t.list=e.list,t.totalCount=e.totalCount})},showCreate:function(){console.log("showCreate"),this.tempObj={categoryId:this.categoryList[0].id,status:0,images:"",videos:""},this.tempObj.imageList=[],this.tempObj.videoList=[],this.dialogStatus="add",this.title="新增文章",this.dialogFormVisible=!0},showUpdate:function(t){console.log("showUpdate",t),this.tempObj=t;var e=[],i=[];if(this.tempObj.images.indexOf(",")>0)for(var a=this.tempObj.images.split(","),s=0;s<a.length;s++)""!==a[s]&&e.push(a[s]);if(this.tempObj.imageList=e,this.tempObj.videos.indexOf(",")>0){a=this.tempObj.videos.split(",");for(var l=0;l<a.length;l++)""!==a[l]&&i.push(a[l])}this.tempObj.videoList=i,this.dialogStatus="update",this.title="修改文章",this.dialogFormVisible=!0},updateData:function(){var t=this;if(!this.checkdAll()){for(var e="",i=0;i<this.tempObj.imageList.length;i++)e+=this.tempObj.imageList[i]+",";for(var s="",l=0;l<this.tempObj.videoList.length;l++)s+=this.tempObj.videoList[l]+",";this.tempObj.images=e,this.tempObj.videos=s,Object(a.a)({url:"/article/saveOrUpdateArticle",method:"post",data:this.tempObj}).then(function(){t.getList(),t.dialogFormVisible=!1,t.$message({message:"操作成功",type:"success"})})}},checkdAll:function(){return!1},handleAvatarSuccess:function(t,e){console.log("handleAvatarSuccess"),0===t.code?(this.tempObj.titleImg=t.data,this.$forceUpdate()):this.$message.error(t.msg)},beforeAvatarUpload:function(t){return!0},handleRemoveResource:function(t,e){console.log("删除"+t);var i=[];for(var a in 1==e&&(i=this.tempObj.imageList),2==e&&(i=this.tempObj.videoList),i)i[a]===t&&i.splice(a,1);1==e&&(this.tempObj.imageList=i),2==e&&(this.tempObj.videoList=i),this.$forceUpdate()},beforeUpload:function(t){return!0},handleRemove:function(t,e){var i=t.url,a=this.tempObj.imageList;for(var s in a)a[s]===i&&a.splice(s,1);return this.tempObj.imageList=a,this.$forceUpdate(),!1},handleResourceSuccess:function(t,e,i){var a=e.response.data;console.log("上传成功",a),this.tempObj.imageList.push(a),console.log(this.tempObj.imageList),this.$forceUpdate()},handleResourceSuccessVideo:function(t,e,i){var a=e.response.data;console.log("上传成功",a),this.tempObj.videoList.push(a),console.log(this.tempObj.videoList),this.$forceUpdate()},beforeUploadVideo:function(t){var e=t.size/1024/1024<50;return-1==["video/mp4","video/ogg","video/flv","video/avi","video/wmv","video/rmvb","video/mov"].indexOf(t.type)?(this.$message.error("请上传正确的视频格式"),!1):e?void 0:(this.$message.error("视频大小不能超过50MB"),!1)},handleRemoveVideo:function(t,e){var i=t.url,a=this.tempObj.videoList;for(var s in a)a[s]===i&&a.splice(s,1);return this.tempObj.videoList=a,this.$forceUpdate(),!1}}},l={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"app-container"},[i("div",{staticClass:"filter-container"},[i("el-form",[i("el-form-item",[i("span",{staticClass:"title-contain"},[t._v("文章管理")])])],1),t._v(" "),i("el-form",[i("el-form-item",[i("el-button",{attrs:{type:"primary",icon:"plus"},on:{click:t.showCreate}},[t._v("添加文章")])],1)],1)],1),t._v(" "),i("div",{staticClass:"contain-table"},[i("el-table",{directives:[{name:"loading",rawName:"v-loading.body",value:t.listLoading,expression:"listLoading",modifiers:{body:!0}}],attrs:{data:t.list,"element-loading-text":"拼命加载中",height:"400"}},[i("el-table-column",{attrs:{align:"center",label:"文章编号",prop:"id","min-width":"25%"}}),t._v(" "),i("el-table-column",{attrs:{align:"center",label:"title图片",prop:"imageUrl","min-width":"20%"},scopedSlots:t._u([{key:"default",fn:function(t){return[i("img",{staticStyle:{height:"40px"},attrs:{src:t.row.titleImg}})]}}])}),t._v(" "),i("el-table-column",{attrs:{align:"center",label:"标题",prop:"title","min-width":"25%"}}),t._v(" "),i("el-table-column",{attrs:{align:"center",label:"课程名称",prop:"courseName","min-width":"25%"}}),t._v(" "),i("el-table-column",{attrs:{align:"center",label:"类别",prop:"categoryName","min-width":"25%"}}),t._v(" "),i("el-table-column",{attrs:{align:"center",label:"创建时间",prop:"gmtCreate","min-width":"40%",formatter:t.yyyymmddhhiiss}}),t._v(" "),i("el-table-column",{attrs:{align:"center",label:"操作","min-width":"20%"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-col",{attrs:{span:6}},[i("el-button",{attrs:{type:"primary",icon:"plus"},on:{click:function(i){t.showUpdate(e.row)}}},[t._v("编辑")])],1)]}}])})],1)],1),t._v(" "),i("div",{staticClass:"page-bottom"},[i("el-pagination",{attrs:{"current-page":t.listQuery.pageNum,"page-size":t.listQuery.pageRow,total:t.totalCount,"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1),t._v(" "),i("el-dialog",{attrs:{title:t.title,visible:t.dialogFormVisible,customClass:"customWidth"},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[i("el-form",{staticClass:"small-space",staticStyle:{width:"71%","margin-left":"50px"},attrs:{model:t.tempObj,"label-position":"left","label-width":"100px"}},[i("el-form-item",{attrs:{required:"",label:"title图片",required:""}},[i("div",{staticClass:"rotary-image"},[i("el-upload",{staticClass:"avatar-uploader",attrs:{action:t.uploadurl,accept:"image/jpeg,image/gif,image/png","show-file-list":!1,"on-success":t.handleAvatarSuccess,"before-upload":t.beforeAvatarUpload}},[t.tempObj.titleImg?i("img",{staticClass:"avatar2",attrs:{src:t.tempObj.titleImg}}):i("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1)]),t._v(" "),i("el-form-item",{attrs:{label:"标题"}},[i("el-input",{attrs:{type:"text",placeholder:"请输入"},model:{value:t.tempObj.title,callback:function(e){t.$set(t.tempObj,"title",e)},expression:"tempObj.title"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"类别"}},[i("el-select",{attrs:{placeholder:"请选择"},model:{value:t.tempObj.categoryId,callback:function(e){t.$set(t.tempObj,"categoryId",e)},expression:"tempObj.categoryId"}},t._l(t.categoryList,function(t){return i("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1),t._v(" "),i("el-form-item",{attrs:{label:"内容"}},[i("el-input",{attrs:{type:"textarea",placeholder:"请输入",rows:4},model:{value:t.tempObj.content,callback:function(e){t.$set(t.tempObj,"content",e)},expression:"tempObj.content"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"详情图"}},[i("div",{staticClass:"imagelist clearfix"},[t._l(t.tempObj.imageList,function(e,a){return i("div",[i("div",{staticStyle:{position:"relative",width:"148px",float:"left","margin-right":"1%","margin-bottom":"2%",border:"1px solid #d9d9d9 !important"}},[i("el-image",{attrs:{src:e,"preview-src-list":t.tempObj.imageList}}),t._v(" "),i("div",{staticClass:"guandiao",on:{click:function(i){t.handleRemoveResource(e,1)}}},[t._v("x")])],1)])}),t._v(" "),i("el-upload",{staticClass:"avatar-uploader",attrs:{"list-type":"picture-card",action:t.uploadurl,"show-file-list":!1,multiple:"","before-upload":t.beforeUpload,"on-remove":t.handleRemove,"on-success":t.handleResourceSuccess}},[i("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],2)]),t._v(" "),i("el-form-item",{attrs:{label:"音频"}},[i("div",{staticClass:"video-list videolist",staticStyle:{position:"relative"}},[i("el-upload",{staticClass:"avatar-uploader",attrs:{action:t.uploadurl,"show-file-list":!1,"on-success":t.handleResourceSuccessVideo,"on-remove":t.handleRemoveVideo,"before-upload":t.beforeUploadVideo}},[i("div",{staticStyle:{position:"relative"}},[null!=t.tempObj.videoList&&0==t.tempObj.videoList.length?i("i",{staticClass:"el-icon-plus avatar-uploader-icon"}):t._l(t.tempObj.videoList,function(e,a){return i("div",[i("video",{staticClass:"video-avatar",staticStyle:{height:"180px"},attrs:{src:e,controls:"controls"}},[t._v("\n                  您的浏览器不支持视频播放\n                ")])])})],2)]),t._v(" "),i("span",{staticClass:"tip-title"},[t._v("最多上传一个视频")]),t._v(" "),null!=t.tempObj.videoList&&t.tempObj.videoList.length>0?i("div",{staticClass:"guandiao",on:{click:function(e){t.handleRemoveResource(t.tempObj.videoList[0],2)}}},[t._v("x")]):t._e()],1)]),t._v(" "),i("el-form-item",{attrs:{label:"是否开启活动"}},[i("el-radio-group",{model:{value:t.tempObj.status,callback:function(e){t.$set(t.tempObj,"status",e)},expression:"tempObj.status"}},[i("el-radio",{attrs:{label:0}},[t._v("关闭")]),t._v(" "),i("el-radio",{attrs:{label:1}},[t._v("启用")])],1)],1)],1),t._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){t.dialogFormVisible=!1}}},[t._v("取 消")]),t._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:t.updateData}},[t._v("确认")])],1)],1)],1)},staticRenderFns:[]},o=i("/Xao")(s,l,!1,null,null,null);e.default=o.exports}});